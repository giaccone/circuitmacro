\documentclass[a4paper,12pt]{article}

\usepackage{geometry}
\geometry{margin=2.5cm}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{titlesec}
\usepackage{titling}
\usepackage{circuitmacro}

\usepackage{listings}
\lstset{basicstyle=\ttfamily, columns=fullflexible, breaklines=true}
% Define custom color scheme
\definecolor{ltgray}{rgb}{0.95,0.95,0.95}
\definecolor{purple}{rgb}{0.5,0,0.5}
\definecolor{darkgreen}{rgb}{0,0.6,0}
\definecolor{darkblue}{rgb}{0,0,0.6}
\definecolor{brickred}{rgb}{0.7,0.1,0.1}
% Define listings style for LaTeX code
\lstdefinestyle{latexstyle}{
  backgroundcolor=\color{ltgray},
  basicstyle=\ttfamily\small,
  keywordstyle=\color{purple},
  commentstyle=\color{darkgreen}\itshape,
  stringstyle=\color{brickred},
  identifierstyle=\color{black},
  showstringspaces=false,
  frame=single,
  rulecolor=\color{black},
  breaklines=true,
  language=[LaTeX]TeX,
  morekeywords={R, L, C, B, SwOpen, SwClosed, Short, Open, Vs, Is, cVs, cIs,
    V, I, Nodes, Terminal, Label, PLoad, YLoad, DLoad, triLine, triShort, triGen}, % add your macro names here
  moredelim=**[is][\color{darkblue}]{@}{@}, % for custom highlighting
}

\setlist{noitemsep}
\setlength{\parindent}{0pt}

\title{User Guide for \texttt{circuitmacro.sty}}
\author{Luca Giaccone}
\date{\today}

\begin{document}

\maketitle

\tableofcontents
\newpage

\section{Introduction}

This document provides a complete user guide for the \texttt{circuitmacro.sty} package, authored by Luca Giaccone. The package extends \texttt{circuitikz} by introducing macros that simplify the drawing of common DC, AC, and three-phase circuit components.

The only external dependencies are:
\begin{itemize}
    \item \texttt{circuitikz}
    \item \texttt{xstring}
\end{itemize}

Put the file either in project directory or in the \texttt{TEXHOME} tree. These are the corret path for different operating systems:

\begin{center}
    \centering
    \begin{tabular}{l  l}
        \hline
        macOS: & \texttt{/Users/<username>/Library/texmf/tex/latex/circuitmacro/} \\
        Linux: & \texttt{/home/<username>/texmf/tex/latex/circuitmacro/} \\
        \hline
    \end{tabular}
   
\end{center}



% \section{General Notes}

% \begin{itemize}
%     \item All coordinate pairs (e.g., \texttt{\{0,0\}}) must be passed \textbf{without parentheses}.
%     \item Optional arguments may be used to add labels, set orientation, or tweak layout.
%     \item The macros are built on top of \texttt{circuitikz} and follow its drawing conventions.
% \end{itemize}

%---------------------
\section{Commands Overview and Examples}
%---------------------
\subsection{Resistor: \texttt{\textbackslash R}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\R[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\R{0,0}{0,3}{R_1}
	\R*{3,0}{3,3}{R_2}
	\R[i=$I_3$]{4,0}{7,3}{R_3}
	\R[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{R_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\R{0,0}{0,3}{R_1}
	\R*{3,0}{3,3}{R_2}
	\R[i=$I_3$]{4,0}{7,3}{R_3}
	\R[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{R_4}
\end{circuitikz}
\end{center}


%---------------------
\subsection{Inductor: \texttt{\textbackslash L}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\L[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\L{0,0}{0,3}{L_1}
	\L*{3,0}{3,3}{L_2}
	\L[i=$I_3$]{4,0}{7,3}{L_3}
	\L[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{L_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\L{0,0}{0,3}{L_1}
	\L*{3,0}{3,3}{L_2}
	\L[i=$I_3$]{4,0}{7,3}{L_3}
	\L[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{L_4}
\end{circuitikz}
\end{center}



%---------------------
\subsection{Capacitor: \texttt{\textbackslash C}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\C[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\C{0,0}{0,3}{C_1}
	\C*{3,0}{3,3}{C_2}
	\C[i=$I_3$]{4,0}{7,3}{C_3}
	\C[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{C_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\C{0,0}{0,3}{C_1}
	\C*{3,0}{3,3}{C_2}
	\C[i=$I_3$]{4,0}{7,3}{C_3}
	\C[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{C_4}
\end{circuitikz}
\end{center}

%---------------------
\subsection{Generic bipole (e.g. impedance): \texttt{\textbackslash B}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\B[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\B{0,0}{0,3}{\bar{Z}_1}
	\B*{3,0}{3,3}{\bar{Z}_2}
	\B[i=$I_3$]{4,0}{7,3}{\bar{Z}_3}
	\B[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{\bar{Z}_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\B{0,0}{0,3}{\bar{Z}_1}
	\B*{3,0}{3,3}{\bar{Z}_2}
	\B[i=$I_3$]{4,0}{7,3}{\bar{Z}_3}
	\B[v=$V_4$, i^<=$I_4$, *-*]{7,0}{10,3}{\bar{Z}_4}
\end{circuitikz}
\end{center}

%---------------------
\subsection{Switch open: \texttt{\textbackslash SwOpen}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\SwOpen[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\SwOpen{0,0}{0,3}{t=0}
	\SwOpen*{3,0}{3,3}{t=0}
	\SwOpen{4,0}{7,3}{t=0}
	\SwOpen[v=$v_s(t)$, *-*]{7,0}{10,3}{t=0}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\SwOpen{0,0}{0,3}{t=0}
	\SwOpen*{3,3}{3,0}{t=t_0}
	\SwOpen*{4,0}{7,3}{t=t_1}
	\SwOpen[v=$v_s(t)$, *-*]{7,0}{10,3}{t=0}
\end{circuitikz}
\end{center}

%---------------------
\subsection{Switch closed: \texttt{\textbackslash SwClosed}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\SwClosed[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
	\SwClosed{0,0}{0,3}{t=0}
	\SwClosed*{3,0}{3,3}{t=0}
	\SwClosed{4,0}{7,3}{t=0}
	\SwClosed[v=$v_s(t)$, *-*]{7,0}{10,3}{t=0}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}
	\SwClosed{0,0}{0,3}{t=0}
	\SwClosed*{3,3}{3,0}{t=t_0}
	\SwClosed{4,0}{7,3}{t=10\:\mathrm{ms}}
	\SwClosed[v=$v_s(t)$, *-*]{7,0}{10,3}{t=0}
\end{circuitikz}
\end{center}


%---------------------
\subsection{Short circuit (e.g. connection): \texttt{\textbackslash Short}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\Short[<circuitikz options>]{<start>}{<end>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}[scale=1]
	\Short{0,0}{0,3}
	\Short[i<=$I_{cc2}$,*-*]{2.5,0}{2.5,3}
	\Short[i_=$I_{cc3}$, o-o]{4,0}{7,3}
	\Short[i_<=$I_{cc4}$]{7,0}{10,3}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}[scale=1]
	\Short{0,0}{0,3}
	\Short[i<=$I_{cc2}$,*-*]{2.5,0}{2.5,3}
	\Short[i_=$I_{cc3}$, o-o]{4,0}{7,3}
	\Short[i_<=$I_{cc4}$]{7,0}{10,3}
\end{circuitikz}
\end{center}


%---------------------
\subsection{Open circuit: \texttt{\textbackslash Open}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\Open[<circuitikz options>]{<start>}{<end>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}[scale=1]
	\Open[v=$V_{oc1}$, *-*]{0,0}{0,3}
	\Open[v_=$V_{oc2}$, o-o]{2.5,0}{2.5,3}
	\Open[v<=$V_{oc3}$, *-*]{4,0}{7,3}
	\Open[v_<=$V_{oc4}$, o-o]{7,0}{10,3}
\end{circuitikz}
\end{lstlisting}


\begin{center}
\begin{circuitikz}[scale=1]
	\Open[v=$V_{oc1}$, *-*]{0,0}{0,3}
	\Open[v_=$V_{oc2}$, o-o]{2.5,0}{2.5,3}
	\Open[v<=$V_{oc3}$, *-*]{4,0}{7,3}
	\Open[v_<=$V_{oc4}$, o-o]{7,0}{10,3}
\end{circuitikz}
\end{center}

%---------------------
\subsection{Independent voltage source: \texttt{\textbackslash Vs}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\Vs[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \Vs[i=$I_1$]{0,3}{0,0}{E_1}
    \Vs*{3,3}{3,0}{E_2}
    \Vs{4,0}{7,3}{}
    \Vs*[i=$I_4$, *-*]{7,0}{10,3}{E_4}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
            \Vs[i=$I_1$]{0,3}{0,0}{E_1}
            \Vs*{3,3}{3,0}{E_2}
            \Vs{4,0}{7,3}{}
            \Vs*[i=$I_4$, *-*]{7,0}{10,3}{E_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Independent current source: \texttt{\textbackslash Is}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\Is[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \Is[v>=$V_1$]{0,0}{0,3}{A_1}
    \Is*{3,0}{3,3}{A_2}
    \Is{7,3}{4,0}{A_3}
    \Is*[v^>=$V_4$, *-*]{10,3}{7,0}{A_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
    \begin{circuitikz}
        \Is[v>=$V_1$]{0,0}{0,3}{A_1}
        \Is*{3,0}{3,3}{A_2}
        \Is{7,3}{4,0}{A_3}
        \Is*[v^>=$V_4$, *-*]{10,3}{7,0}{A_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Controlled voltage source: \texttt{\textbackslash cVs}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\cVs[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \cVs[i=$I_1$]{0,3}{0,0}{E_1}
    \cVs*{3,3}{3,0}{E_2}
    \cVs{4,0}{7,3}{}
    \cVs*[i=$I_4$, *-*]{7,0}{10,3}{E_4}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
            \cVs[i=$I_1$]{0,3}{0,0}{E_1}
            \cVs*{3,3}{3,0}{E_2}
            \cVs{4,0}{7,3}{}
            \cVs*[i=$I_4$, *-*]{7,0}{10,3}{E_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Controlled current source: \texttt{\textbackslash cIs}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\cIs[<circuitikz options>]{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \cIs[v>=$V_1$]{0,0}{0,3}{A_1}
    \cIs*{3,0}{3,3}{A_2}
    \cIs{7,3}{4,0}{A_3}
    \cIs*[v^>=$V_4$, *-*]{10,3}{7,0}{A_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
    \begin{circuitikz}
        \cIs[v>=$V_1$]{0,0}{0,3}{A_1}
        \cIs*{3,0}{3,3}{A_2}
        \cIs{7,3}{4,0}{A_3}
        \cIs*[v^>=$V_4$, *-*]{10,3}{7,0}{A_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Voltage: \texttt{\textbackslash V}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\V{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}[scale=1]
    \V{0,0}{0,3}{V_1}
    \V*{3,0}{3,3}{V_2}
    \V{4,0}{7,3}{V_3}
    \V{10,3}{7,0}{V_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
    \begin{circuitikz}[scale=1]
        \V{0,0}{0,3}{V_1}
        \V*{3,0}{3,3}{V_2}
        \V{4,0}{7,3}{V_3}
        \V{10,3}{7,0}{V_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Current: \texttt{\textbackslash I}}
%---------------------

\textbf{Signature:}
\begin{verbatim}
\I{<start>}{<end>}{<label>}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \I{0,0}{0,1}{I_1}
    \I*{2,0}{2,1}{I_2}
    \I{4,0}{5,1}{I_3}
    \I{8,1}{7,0}{I_4}
\end{circuitikz}
\end{lstlisting}


\begin{center}
    \begin{circuitikz}
        \I{0,0}{0,1}{I_1}
        \I*{2,0}{2,1}{I_2}
        \I{4,0}{5,1}{I_3}
        \I{8,1}{7,0}{I_4}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Nodes: \texttt{\textbackslash Nodes}}
%---------------------


\textbf{Signature:}
\begin{verbatim}
\Nodes{coordinates1}{coordinates1} ... {coordinatesn}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \Nodes{0,0}{1,1}
    \Nodes*{4,0}{5,0}{5,1}{4,1}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \Nodes{0,0}{1,1}
        \Nodes*{4,0}{5,0}{5,1}{4,1}
    \end{circuitikz}
\end{center}

\newpage
%---------------------
\subsection{Terminal: \texttt{\textbackslash Terminal}}
%---------------------
\begin{verbatim}
\Terminal{from}{to}{label}
\end{verbatim}

\textbf{Example:}


\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    % some resistors
    \R[*-*]{1,1}{1,3}{R_1}
    \R{1,3}{3,3}{R_2}
    \R[*-*]{3,3}{3,1}{R_3}
    \R{1,1}{3,1}{R_4}
    
    % terminals
    \Terminal{0,0}{1,1}{A}
    \Terminal{0,4}{1,3}{B}
    \Terminal{4,4}{3,3}{C}
    \Terminal{4,0}{3,1}{D}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        % some resistors
        \R[*-*]{1,1}{1,3}{R_1}
        \R{1,3}{3,3}{R_2}
        \R[*-*]{3,3}{3,1}{R_3}
        \R{1,1}{3,1}{R_4}
        
        % terminals
        \Terminal{0,0}{1,1}{A}
        \Terminal{0,4}{1,3}{B}
        \Terminal{4,4}{3,3}{C}
        \Terminal{4,0}{3,1}{D}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Label: \texttt{\textbackslash Label}}
%---------------------
\begin{center}
    \begin{circuitikz}
        \Nodes{0,0}{5,0}   % nodes are used for the sake of understanding \Label
        \Label[above]{0,0}{I'm above the node}
        \Label[below]{0,0}{I'm below the node}
        \Label[left, red]{5,0}{$B$}
        \Label[right, blue]{5,0}{$D$}
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Power load (single phase or three phase): \texttt{\textbackslash PLoad}}
%---------------------
\begin{verbatim}
\PLoad[labe1][label2]{dx}{dy}{origin}
\end{verbatim}

\textbf{Example:}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \PLoad[P][Q]{2}{4}{0,0}
    \PLoad[Q_c]{3}{1}{7,0}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \PLoad[P][Q]{2}{4}{0,0}
        \PLoad[Q_c]{3}{1}{7,0} % single label is centered

        \Nodes*{0,0}
        \draw[-latex, dashed, gray, line width=1.5pt] (-3,0) -- (-0.3,0) node [midway, above] {origin=\{0,0\}};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (0,-2.5) -- (2,-2.5) node [midway, below] {dx=2};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (2.5,-2) -- (2.5,2) node [midway, right] {dy=4};

        \Nodes*{7,0}
        \draw[-latex, dashed, gray, line width=1.5pt] (7,2) -- (7,0.3) node [midway, right] {origin=\{7,0\}};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (5.5,-1.5) -- (8.5,-1.5) node [midway, below] {dx=3};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (9,-1) -- (9,0) node [midway, right] {dy=1};




    \end{circuitikz}
\end{center}

%---------------------
\subsection{Star connected load: \texttt{\textbackslash YLoad}}
%---------------------
\textbf{Signature:}
\begin{verbatim}
\YLoad[B|R|L|C]{scale}{start}{end}{gap}{label1}{label2}{label3}
\end{verbatim}

\textbf{Example:}
\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \YLoad{1}{0,0}{3,0}{2}{\bar{Z}}{}{}
    \YLoad[R]{0.8}{7,-1}{8.5,1}{1.5}{R_1}{R_2}{R_3}
    \YLoad*[C]{0.5}{13,0}{11,0}{1}{C}{}{}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \YLoad{1}{0,0}{3,0}{2}{\bar{Z}}{}{}
        \YLoad[R]{0.8}{7,-1}{8.5,1}{1.5}{R_1}{R_2}{R_3}
        \YLoad*[C]{0.5}{13,0}{11,0}{1}{C}{}{}

        \Nodes*{0,0}
        \draw [-latex,dashed, gray, line width=1.5pt] (-2, 0) -- (-0.1,0) node [midway, above] {start};
        \draw [-latex,dashed, gray, line width=1.5pt] (5, 0) -- (3.1,0) node [midway, above] {end};
        \draw [latex-latex,dashed, gray, line width=1.5pt] (0, -0.1) -- (0,-1.9) node [midway, left] {gap};
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Triangle connected load: \texttt{\textbackslash DLoad}}
%---------------------
\textbf{Signature:}
\begin{verbatim}
\DLoad[B|R|L|C]{scale}{start}{end}{gap}{label1}{label2}{label3}
\end{verbatim}

\textbf{Example:}
\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \DLoad{1}{0,0}{3,0}{2}{\bar{Z}_1}{\bar{Z}_2}{\bar{Z}_3}
    \DLoad{0.5}{7,0}{10,0}{2}{\bar{Z}_1}{\bar{Z}_2}{\bar{Z}_3}
    \DLoad[R]{0.5}{4,-5}{6,-3}{2}{R}{}{}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \DLoad{1}{0,0}{3,0}{2}{\bar{Z}_1}{\bar{Z}_2}{\bar{Z}_3}
        \DLoad{0.5}{7,0}{10,0}{2}{\bar{Z}_1}{\bar{Z}_2}{\bar{Z}_3}
        \DLoad[R]{0.5}{5,-4}{6,-3}{1}{R}{}{}
        

        \Nodes*{0,0}{3,0}
        \draw [-latex,dashed, gray, line width=1.5pt] (-2, 0) -- (-0.1,0) node [midway, above] {start};
        \draw [-latex,dashed, gray, line width=1.5pt] (5, 1) -- (3.1,0) node [midway, above] {end\hspace{10pt} };
        \draw [latex-latex,dashed, gray, line width=1.5pt] (0, -0.1) -- (0,-1.9) node [midway, left] {gap};
        \draw [latex-latex,dashed, gray, line width=1.5pt] (0, 2.2) -- (1.2,2.2) node [midway, above] {40\% (end - start)};
    \end{circuitikz}
\end{center}

%---------------------
\subsection{Three phase line: \texttt{\textbackslash triLine}}
%---------------------
\textbf{Signature:}
\begin{verbatim}
\triLine[B|R|L|C]{scale}{start}{end}{gap}{label1}{label2}{label3}
\end{verbatim}

\textbf{Example:}
\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \triLine{1}{0,0}{3,0}{2}{\bar{Z}}{}{}
    \triLine[R]{0.8}{7,-1}{8.5,1}{1.5}{R_1}{R_2}{R_3}
    \triLine*[C]{0.5}{13,0}{11,0}{1}{C}{}{}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \triLine{1}{0,0}{3,0}{2}{\bar{Z}}{}{}
        \triLine[R]{0.8}{7,-1}{8.5,1}{1.5}{R_1}{R_2}{R_3}
        \triLine*[C]{0.5}{13,0}{11,0}{1}{C}{}{}

        \Nodes*{0,0}{3,0}
        \draw [-latex,dashed, gray, line width=1.5pt] (-2, 0) -- (-0.1,0) node [midway, above] {start};
        \draw [-latex,dashed, gray, line width=1.5pt] (5, 0) -- (3.1,0) node [midway, above] {end};
        \draw [latex-latex,dashed, gray, line width=1.5pt] (0, -0.1) -- (0,-1.9) node [midway, left] {gap};
    \end{circuitikz}
\end{center}


%---------------------
\subsection{Three phase connection: \texttt{\textbackslash triShort}}
%---------------------
\textbf{Signature:}
\begin{verbatim}
\triShort[<circuitikz options>][<cut>]{start}{end}{gap}
\end{verbatim}

\textbf{Example:}
\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \triShort{0,0}{3,0}{2}
    \triShort[*-][1]{7,2}{7,-3}{1}
    \triShort*[*-][1]{12,2}{12,-2}{1}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \triShort{0,0}{3,0}{2}
        \triShort[*-][1]{7,2}{7,-3}{1}
        \triShort*[*-][1]{12,2}{12,-2}{1}

        \Nodes*{0,0}{3,0}
        \draw[-latex, dashed, gray, line width=1.5pt] (-2,0) -- (-0.1,0) node [midway, above] {start};
        \draw[-latex, dashed, gray, line width=1.5pt] (5,0) -- (3.1,0) node [midway, above] {end};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (0,-1.9) -- (0,-0.1) node [midway, right] {gap};

        \Nodes*{7,2}{7,-3}
        \draw[-latex, dashed, gray, line width=1.5pt] (9,2) -- (7.1,2) node [midway, above] {start};
        \draw[-latex, dashed, gray, line width=1.5pt] (8,-4) -- (7,-3.1) node [midway, right] {\hspace{5pt}end};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (6.1,-3) -- (6.9,-3) node [midway, below] {gap};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (8,0.1) -- (8,0.9) node [midway, right] {cut};
        \draw[latex-latex, dashed, gray, line width=1.5pt] (8,1.1) -- (8,1.9) node [midway, right] {cut};
        \draw[dashed, gray, line width=1.5pt] (7,1) -- (9,1);
    \end{circuitikz}
\end{center}


%---------------------
\subsection{Three phase generator: \texttt{\textbackslash triGen}}
%---------------------
\textbf{Signature:}
\begin{verbatim}
\triGen[V|I][scale]{start}{end}{gap}{label1}{label2}{label3}
\end{verbatim}

(N.B. \texttt{scale} does not work perfectly here. It is included for future development and it is suggested to leave it to the default value (i.e. 1). In this version labels, plus sign for voltage generators and arrows for current generators do not scale according to \texttt{scale} parameters.)

\vspace{0.5cm}

\textbf{Example:}
\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \triGen{0,0}{3,0}{2}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
    \triGen*{8,-2}{11,1}{2}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
    \triGen[I]{5,-3}{5,-6}{2}{\bar{A}_1}{\bar{A}_2}{\bar{A}_3}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        \triGen{0,0}{3,0}{2}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
        \triGen*{8,-2}{11,1}{2}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
        \triGen[I]{5,-3}{5,-6}{2}{\bar{A}_1}{\bar{A}_2}{\bar{A}_3}

        \Nodes*{3,0}
        \draw[-latex, dashed, gray, line width=1.5pt] (-2,0) -- (-0.1,0) node [midway, above] {start};
        \draw[-latex, dashed, gray, line width=1.5pt] (4,1) -- (3.1,0.1) node [midway, above] {end\hspace{15pt} };
        \draw[latex-latex, dashed, gray, line width=1.5pt] (3.2,-2) -- (3.2,0) node [midway, right] {gap=2};
    \end{circuitikz}
\end{center}



\newpage
\section{Example Circuits}

\subsection{Example 1: first order circuit}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \Vs{0,3}{0,0}{E_1}
    \R{0,3}{3,3}{R_1}
    \R{0,0}{3,0}{R_2}
    \Is[*-*]{3,0}{3,3}{A_1}
    \R[-*]{3,3}{6,0}{R_3}
    \R[-*]{3,3}{6,3}{R_4}
    \SwOpen{6,3}{9,3}{t=0}
    \C[v<=$v(t)$]{9,3}{9,0}{C_1}
    \Short{3,0}{9,0}
    \Short{6,0}{6,3}
\end{circuitikz}
\end{lstlisting}

\begin{center}
	\begin{circuitikz}
		\Vs{0,3}{0,0}{E_1}
		\R{0,3}{3,3}{R_1}
		\R{0,0}{3,0}{R_2}
		\Is[*-*]{3,0}{3,3}{A_1}
		\R[-*]{3,3}{6,0}{R_3}
		\R[-*]{3,3}{6,3}{R_4}
		\SwOpen{6,3}{9,3}{t=0}
		\C[v<=$v(t)$]{9,3}{9,0}{C_1}
        \Short{3,0}{9,0}
        \Short{6,0}{6,3}
	\end{circuitikz}
\end{center}

\newpage
\subsection{Example 2: AC Circuit}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    \Vs{0,6}{0,0}{\bar{E}_1}
    \Is[*-*]{3,3}{6,3}{\bar{A}_1}
    \B[*-, v<=$\bar{V}_1$]{3,6}{3,3}{\bar{Z}_1}
    \B[-*, i=$\bar{I}_2$]{3,3}{3,0}{\bar{Z}_2}
    \B[i^<=$\bar{I}_3$]{6,6}{6,3}{\bar{Z}_3}
    \B[v<=$\bar{V}_4$]{6,3}{6,0}{\bar{Z}_4}
    \Short{0,0}{6,0}
    \Short{0,6}{6,6}
\end{circuitikz} 
\end{lstlisting}

\begin{center}
	\begin{circuitikz}
		\Vs{0,6}{0,0}{\bar{E}_1}
		\Is[*-*]{3,3}{6,3}{\bar{A}_1}
		\B[*-, v<=$\bar{V}_1$]{3,6}{3,3}{\bar{Z}_1}
		\B[-*, i=$\bar{I}_2$]{3,3}{3,0}{\bar{Z}_2}
		\B[i^<=$\bar{I}_3$]{6,6}{6,3}{\bar{Z}_3}
		\B[v<=$\bar{V}_4$]{6,3}{6,0}{\bar{Z}_4}
		\Short{0,0}{6,0}
		\Short{0,6}{6,6}
	\end{circuitikz}   
\end{center}

\newpage
\subsection{Example 3: Three-Phase Circuit}

\begin{lstlisting}[style=latexstyle]
\begin{circuitikz}
    % generator and line
    \triGen{0,4}{2,4}{1.8}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
    \triLine{1}{2,4}{4.5,4}{1.8}{\bar{Z}_L}{}{}

    % load A
    \triShort{4.5, 4}{9, 4}{1.8}
    \PLoad[P_A][Q_A]{2}{4.5}{9,4}
    
    % load B
    \triShort[*-][1.8]{6.5, 5.8}{6.5, 1}{1.8}
    \PLoad[P_B][Q_B]{4.5}{2}{6.5,1}

    % current and voltages
    \I{8,5.8}{8.5,5.8}{\bar{I}_A}
    \I{4.7,3.5}{4.7,3}{\bar{I}_B}
    \V*{2,4}{2,5.8}{\bar{V}_g}
    \V{8.5,4}{8.5,5.8}{\bar{V}}
\end{circuitikz}
\end{lstlisting}

\begin{center}
    \begin{circuitikz}
        % generator and line
        \triGen{0,4}{2,4}{1.8}{\bar{E}_1}{\bar{E}_2}{\bar{E}_3}
        \triLine{1}{2,4}{4.5,4}{1.8}{\bar{Z}_L}{}{}
    
        % load A
        \triShort{4.5, 4}{9, 4}{1.8}
        \PLoad[P_A][Q_A]{2}{4.5}{9,4}
        
        % load B
        \triShort[*-][1.8]{6.5, 5.8}{6.5, 1}{1.8}
        \PLoad[P_B][Q_B]{4.5}{2}{6.5,1}

        % current and voltages
        \I{8,5.8}{8.5,5.8}{\bar{I}_A}
        \I{4.7,3.5}{4.7,3}{\bar{I}_B}
        \V*{2,4}{2,5.8}{\bar{V}_g}
        \V{8.5,4}{8.5,5.8}{\bar{V}}
    \end{circuitikz}
\end{center}

% \section{Final Notes}

% Ensure that the \texttt{circuit.sty} file is in your local project directory or in your \texttt{TEXMFHOME} tree. This guide provides all needed information and examples for typical usage of the macros defined in the package.

\end{document}
